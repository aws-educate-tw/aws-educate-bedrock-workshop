const { ChatPromptTemplate } = require("@langchain/core/prompts");

const AETHERIA_WORLDBUILDING = `
# 艾瑟里亞魔法世界觀設定

## 世界概述
艾瑟里亞是一個與現代人類世界平行存在的魔法文明。這個世界隱藏在普通人（稱為「凡塵者」）的認知之外，透過古老的結界魔法維持著兩個世界的分隔。

三千年前，「大分離」(The Great Severance) 災難使絕大多數人類失去了感知魔法的能力。倖存下來仍保有魔法能力的人們，建立了隱蔽的城市、嚴格的保密法規，發展出獨特的文化與傳統。

## 魔法本質
魔法是流動於萬物之間的能量，稱為「以太」(Aether)。魔法師能透過意念、咒語和媒介（魔杖、符文、藥劑）引導這股能量。

魔法定律：
- 守恆定律：魔法無法無中生有
- 意志定律：魔法強度與施法者意志力成正比
- 共鳴定律：特定材料、時間、地點會增強魔法效果
- 代價定律：越強大的魔法，代價越大

## 血統制度
- 純血 (Purebloods)：連續七代以上皆為魔法師的後裔，擁有悠久歷史與政治影響力
- 混血 (Halfbloods)：父母之中有一方是魔法師，佔社會大多數
- 凡塵初覺者 (Firstblooms)：出生於凡塵家庭卻擁有魔法能力的人
- 凡塵者 (Mundanes)：沒有魔法能力的普通人

代表純血家族：月華家族（占卜預言）、焰心家族（戰鬥魔法）、星辰家族（天文空間魔法）、幽影家族（黑魔法，有爭議）

## 四大魔法學院（幻霧學園）

### 曙光學院 (House of Dawnfire)
- 元素：火與光｜動物：鳳凰｜色彩：緋紅與金色
- 院訓：「以勇氣照亮黑暗」
- 特質：勇敢、正直、領導力
- 職業傾向：戰鬥魔法師、執法官、冒險家

### 銀月學院 (House of Silvermoon)
- 元素：水與月｜動物：銀狼｜色彩：銀色與深藍
- 院訓：「智慧是最強大的魔法」
- 特質：聰明、好學、追求真理
- 職業傾向：學者、研究者、理論魔法師

### 翠蔭學院 (House of Verdantshade)
- 元素：土與木｜動物：百年靈龜｜色彩：翠綠與棕色
- 院訓：「忠誠與善良永不凋零」
- 特質：善良、忠誠、腳踏實地
- 職業傾向：治療師、藥劑師、護魔生物學家

### 暮影學院 (House of Duskshadow)
- 元素：風與影｜動物：暗夜鴉｜色彩：紫黑與銀灰
- 院訓：「野心是成功的階梯」
- 特質：野心、機智、足智多謀
- 職業傾向：企業家、政治家、創新者

新生透過「靈魂共鳴儀式」觸碰「四元聖杯」進行學院分配，聖杯感應的是學生「最渴望成為什麼樣的人」。

## 魔法類型
- 元素魔法：火、水、風、土及衍生元素
- 變形魔法：改變物質形態
- 咒術魔法：對物品施加持續性效果
- 召喚魔法：從虛空召喚物品或生物
- 心靈魔法：影響心智、情緒和記憶（嚴格管制）
- 治療魔法：治癒傷病、恢復體力

## 禁忌魔法（黑魔法三禁咒）
1. 絕對支配咒：完全控制目標意志
2. 永恆苦痛咒：使目標承受極度痛苦
3. 靈魂毀滅咒：直接摧毀目標靈魂

## 魔法生物
- 智慧種族：家精靈、哥布林、人馬、人魚
- 常見生物：鳳凰、獨角獸、龍、鷹馬、夜騏
- 危險生物：催狂魔、狼人

## 重要地點
- 幻霧學園：位於魔法迷霧環繞的山谷，有移動樓梯、魔法天花板、禁忌森林
- 星辰巷：魔法世界最大商業街，有魔杖店、書店、藥房
- 金庫銀行：哥布林經營，深入地下數百公尺
- 魔法部：隱藏在城市地下的行政機構
- 虛空牢獄：關押重刑犯的空間裂隙監獄

## 日常生活
- 交通：掃帚飛行、壁爐網絡、幻影移形、港口鑰
- 通訊：貓頭鷹郵件、雙面鏡
- 娛樂：魁地奇、爆炸牌、魔法棋
- 職業：執法官、治療師、魔藥師、教授、魁地奇選手、詛咒破解者

## 人生階段
- 童年期 (0-11歲)：發現魔法能力、收到錄取通知
- 學院期 (11-17歲)：學習魔法、分配學院、建立人際關係
- 成年期 (18-40歲)：選擇職業、建立事業家庭、面對道德抉擇
- 長老期 (40+歲)：回顧成就、傳承知識、留下貢獻

## 核心主題
- 選擇與後果：每個選擇都有代價
- 身份認同：選擇定義你，而非出身
- 權力與責任：力量帶來責任
- 偏見與包容：挑戰傳統，接納多元
- 勇氣的定義：面對恐懼仍選擇行動
- 愛與犧牲：最強大的魔法與愛有關

「真正定義一個魔法師的，不是他的血統或天賦，而是他在面對選擇時展現的勇氣與智慧。」—— 幻霧學園創校校長，阿爾卡斯·幻霧
`;

const backgroundPrompt = ChatPromptTemplate.fromMessages([
    [
        "system",
        `你是人生模擬遊戲的背景生成器。
請根據以下艾瑟里亞魔法世界觀，生成一個獨特的遊戲角色背景設定。

${AETHERIA_WORLDBUILDING}

重要規則：
1. 主角必須是童年時期 (7-11歲)，正處於發現自己魔法能力或即將收到幻霧學園錄取通知的階段
2. 背景要包含家庭環境、血統身份、以及童年的特殊經歷
3. 人生目標要與魔法世界的職業或理想相關
4. 初始特質要反映角色的性格傾向，暗示未來可能被分配的學院
5. 必須明確描述主角的性別和外觀特徵（髮色、眼睛顏色、膚色、身高體型等），以便後續生成一致的圖像

輸出必須是有效的 JSON 格式。`,
    ],
    [
        "user",
        `請生成遊戲背景，欄位必須包含：
- background（世界觀與角色背景描述，包含家庭環境和童年經歷，String）
- player_identity（含 age: 7-11歲, gender: 性別, appearance: 外觀描述字串（包含髮色、眼睛顏色、膚色、身材特徵等）, profession: 童年身份如「魔法師家庭的孩子」或「凡塵初覺者」, initial_traits: 3-4個性格特質陣列）
- life_goal（本局人生目標，與魔法世界相關，String）`,
    ],
]);

module.exports = { backgroundPrompt, AETHERIA_WORLDBUILDING };
